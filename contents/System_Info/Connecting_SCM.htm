<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Adobe RoboHelp 2019" />
  <title>Connecting SCM</title>
  <meta name="topic-status" content="Draft" />
  <link rel="stylesheet" type="text/css" href="../assets/css/default.css" />
  <meta name="template" content="../assets/masterpages/SCM.htt" />
</head>
<body>
  <h2 class="SCM_h2" style="border-width: 1px;border-style: solid;border-color: #000000;border-left: 0;border-right: 0">Connect TCP/IP for SCM</h2>
  <h3 class="SCM_h3">Outline</h3>
  <p>An outline to getting other devices and support applications connected to the SwimClubMeet database. For the computer running the MS SQLEXPRESS server, the following must be done.</p>
  <ol class="Decimal">
    <li>Enable TCP for SQLEXPRESS server.</li>
    <li>Set a static port number for SQLEXPRESS server. (Default 1433)</li>
    <li>Restart the SQLEXPRESS server. (While in Computer Management)</li>
    <li>Enable TCP logins for the SwimClubMeet database.</li>
    <li>Restart the SQLEXPRESS server. (While in MSSMS)</li>
    <li>Setup a &#39;scmAdmin&#39; SwimClubMeet database login.</li>
    <li>Set the firewall to allows communications on the port. (UDP, TCP)</li>
    <li>Check the connection.</li>
  </ol>
  <p>On the computer(s) connecting ...</p>
  <ul class="Disc">
    <li>Prepare it&#39;s firewall to allow communications on port 1433 .</li>
    <li>When logging in, use IP address and port of the SQLEXPRESS server.</li>
    <li>Login with username scmAdmin and password.</li>
  </ul>
  <p>Router, Wi-Fi considerations ...</p>
  <ul class="Disc">
    <li>Ensure &#39;port forwarding&#39; is enabled for the static port used by SQLEXPRESS server.</li>
  </ul>
  <p> </p>
  <h3 class="SCM_h3">Detailed step-by-step guide ...</h3>
  <p><span class="expandtext">This guide assumes you have Windows 10 and are running SQLEXPRESS 2017 or 2019. </span></p>
  <h3 class="SCM_h3">Computer Management - Enable TCP for SQLEXPRESS server.</h3>
  <table border="1" cellpadding="1" cellspacing="1" class="SCM_simple" style="border-collapse:collapse;border-width:1px;border-style:none;border-color:#000000" width="100%">
    <colgroup>
      <col width="80%" />
      <col width="50%" />
    </colgroup>
    <tbody style="border-width: 1px;border-style: none;border-color: #000000">
      <tr style="border-width: 1px;border-style: none;border-color: #000000">
        <td style="border-width: 1px;border-style: none;border-color: #000000">
          <p><img class="scmImage" src="../assets/images/ComputerManagementWinRightMouse.jpg" />On the taskbar, in the extreme left, right mouse click the winodws logo.</p>
          <p style="border-width: 1px;border-style: none;border-color: #000000">From the pop-up right menu, select &#39;Computer Management&#39;.</p>
          <p style="border-width: 1px;border-style: none;border-color: #000000"><span class="SCM_Quotes">(The appearance may vary a little - it&#39;s dependant on what Windows 10 build you are running.)</span></p>
        </td>
        <td style="border-width: 1px;border-style: none;border-color: #000000"> </td>
      </tr>
    </tbody>
  </table>
  <p> </p>
  <p style="border-width: 1px;border-style: none;border-color: #000000">The Computer Management app runs. We are looking for &#39;Protocols for SQLEXPRESS&#39;</p>
  <p><img src="../assets/images/ComputerManagement2.JPG" /></p>
  <p>Ensure  &#39;TCP/IP&#39; is enable.</p>
  <h3 class="SCM_h3">Computer Management - Set TCP/IP configuration.</h3>
  <p>Double click &#39;TCP/IP&#39; (found under the column &#39;Protocol Name&#39;) to open the Properties panel.</p>
  <p><img src="../assets/images/ComputerManagement3.JPG" /></p>
  <p>Make sure Listen All is set to Yes.</p>
  <p>Next - select the IP Addresses tab.</p>
  <p><img src="../assets/images/ComputerManagement4.JPG" /></p>
  <p>We are looking for the &#39;IPALL&#39;.</p>
  <p>Blank out the TCP Dynamic Ports by removing it&#39;s &#39;0&#39;</p>
  <p>Put the default SQLEXPRESS server port number &#39;1433&#39; into TCP Port</p>
  <p>Press OK</p>
  <h3 class="SCM_h3">Computer Management - Restart the SQLEXPRESS server.</h3>
  <p>While in the &#39;Computer Management&#39;, lets restart the SQLEXPRESS server.  </p>
  <p>Locate &#39;SQL Server Services&#39; - select it.</p>
  <p><img src="../assets/images/ComputerManagement5.JPG" /></p>
  <p>Next, in right hand panel, select SQL Server (SQLEXPRESS) </p>
  <p><img src="../assets/images/ComputerManagement6.JPG" /></p>
  <p>Right mouse and select &#39;Restart&#39; from the pop-down menu.</p>
  <p>Restarting will ensure all of our changes are applied.</p>
  <p>Ok - if you have made this far then you now have the server listening on port 1433.</p>
  <p>Next step is to get the SQLEXPRESS database to accept remote logins. Close up any apps and lets move on.</p>
  <h3 class="SCM_h3">Enable TCP logins for the SwimClubMeet database.</h3>
  <table border="1" cellpadding="1" cellspacing="1" class="SCM_simple" style="border-collapse:collapse;" width="100%">
    <colgroup>
      <col width="100%" />
    </colgroup>
    <tbody>
      <tr>
        <td style="border-width: 1px;border-style: none;border-color: #000000"><img class="scmImage" src="../assets/images/MSSMS.JPG" style="border-width: 1px; border-style: none; border-color: rgb(0, 0, 0);" />Start the Microsoft SQL Server Management Studio. </td>
      </tr>
    </tbody>
  </table>
  <table border="1" cellpadding="1" cellspacing="1" class="SCM_simple" style="border-collapse:collapse;" width="100%">
    <colgroup>
      <col width="100%" />
    </colgroup>
    <tbody>
      <tr>
        <td>
          <p><br />
            <img class="scmImage" src="../assets/images/MSSMS_Login.jpg" />Connect to your SQLEXPRESS ....</p>
          <p>Server name: localhost\SQLEXPRESS  </p>
          <p>The dot variation, .\SQLEXPRESS,  is another alternative.</p>
          <p>Or a fully qualified server name would be the name of your computer name with an attached instance name. As shown in the example.</p>
          <p> Authentication :</p>
          <p>Here you can use &#39;Windows Authentication&#39;. </p>
        </td>
      </tr>
    </tbody>
  </table>
  <p>Now that you have successfully logged in, the next step is to select the server name (top line).  The right mouse and select Properties from the popup menu</p>
  <p><img src="../assets/images/MSSMS2.JPG" /></p>
  <p>With the Server Properties dialogue open, select the &#39;Security&#39; tab. Then select the radiobutton &#39;SQL Server and Windows Authentication mode&#39;. Doing this will enable remote login using the server&#39;s user accounts.</p>
  <p><img src="../assets/images/MSSMS3.JPG" /></p>
  <p>Press OK. This change won&#39;t come into effect until we restart the server.</p>
  <h3 class="SCM_h3">Restart the SQLEXPRESS server.</h3>
  <p>Select the server name (top line). Right mouse, but this time select &#39;Restart&#39; from the popup menu.</p>
  <p><img src="../assets/images/MSSMS4.JPG" /></p>
  <p>With that done, the next is to setup the remote login.</p>
  <h3 class="SCM_h3">Setup a &#39;scmAdmin&#39; SwimClubMeet remote database login.</h3>
  <p>When the SwimClubMeet application &#39;BuildMeAClub&#39; was ran it created some useful &#39;Roles&#39;, SwimClubMeet Users and a single Login name.</p>
  <p>Open up the Security branch. You&#39;ll see the remote login name scmAdmin. (There are multiply security branches, make sure you have selected the &#39;root&#39; branch&#39; as shown below.)</p>
  <p><img src="../assets/images/MSSMS5.JPG" /></p>
  <p>Currently it&#39;s offline and has a random password. Double click scmAdmin.</p>
  <p><img src="../assets/images/MSSMS6.JPG" /></p>
  <p>In the generals tab - you&#39;ll note, I&#39;ve disabled &#39;Enforce password policy&#39;. That way I can enter a &#39;short&#39; password.</p>
  <p>Go do the same - enter a  password for your scmAdmin user and then confirm the password by typing it again in the &#39;Confirm password&#39; editbox.</p>
  <p>Next we&#39;ll check mappings. Select the &#39;User Mappings&#39; tab. Then select SwimClubMeet and confirm the following ...</p>
  <p><img src="../assets/images/MSSMS7.JPG" /> </p>
  <p>Make sure the following are checked ...</p>
  <ul class="Disc">
    <li>db_datareader</li>
    <li>db_datawriter</li>
    <li>public (optional)</li>
    <li>SCM_Administrator</li>
  </ul>
  <p>The last one, &#39;SCM_Administrator&#39; allows the user scmAdmin to do select actions or tasks to the SwimClubMeet tables. &#39;SCM_Administrator&#39; is a SQLSERVER &#39;role&#39; definition. Some SCM system tables are in-accessable to scmAdmin. However when running any of the SwimClubMeet application, logged in as scmAdmin, all application functionality is operable. (Later... If you explore in the SwimClubMeet security sub-branch, you&#39;ll notice other SCM &#39;roles&#39;.)</p>
  <p>One last job. Select the Status tab. Select the radio button &#39;Enabled&#39; for the &#39;Login&#39; option.</p>
  <p><img src="../assets/images/MSSMS8.JPG" /></p>
  <p>Press OK</p>
  <p>And that should do it. It shouldn&#39;t be necessary to do another restart of the database changes. (?)</p>
  <p>Close down MSSMS. </p>
  <h3 class="SCM_h3">Set the firewall to allows communications on the port. (UDP, TCP)</h3>
  <p>If you have a virus protection application running - then this will block port 1433, unless enabled.</p>
  <p>Here are the steps to enable these port when using Windows Defender Firewall.</p>
  <p><span class="expandtext">(You maybe using a different firewall/security application. Instructions to setup UDP/TCP will differ.)</span></p>
  <p>Type &#39;Fire&#39; in the Windows search box. Select the &#39;Windows Defender Firewall&#39; app.</p>
  <p>Once open, select &#39;Advance Settings&#39;.</p>
  <p><img src="../assets/images/Firewall8.JPG" /></p>
  <p>Here it is open and I&#39;ve selected Inbound Rules. You can see I&#39;ve already made my SQLEXPRESS 1433 TCP inbound rule for the SQLEXPRESS 1433 static port.</p>
  <p><img src="../assets/images/Firewall.JPG" /></p>
  <p>To create an inbound rule, select Action &gt;&gt; New Rule ...</p>
  <p><img src="../assets/images/Firewall2.JPG" /></p>
  <p>When the dialogue has open, select Port, then click Next</p>
  <p><img src="../assets/images/Firewall3.JPG" /></p>
  <p>We need to do both TCP and UDP. Lets start with UDP. Select the UDP radiobutton. Select &#39;Specific local ports&#39; and then enter 1433 in the editbox.</p>
  <p><img src="../assets/images/ProtocolAndPorts.png" /></p>
  <p>Click Next</p>
  <p><img src="../assets/images/Firewall5.JPG" /></p>
  <p>Select &#39;Allow the connection&#39;. Click Next</p>
  <p><img src="../assets/images/Firewall6.JPG" /></p>
  <p>Select all checkboxes (enable across all connections).  Click Next</p>
  <p><img src="../assets/images/Firewall7.JPG" /></p>
  <p>Give it a title, maybe a description then click Finish.</p>
  <p><span class="expandtext">RINSE AND REPEAT. Repeat the same procedure for TCP on port 1433.</span></p>
  <p>Click Finish</p>
  <p>Close the defender firewall application. The SQLEXPRESS 1433 port is now open across all connections.</p>
  <h3 class="SCM_h3">NOW WE MUST CHECK</h3>
  <p>Does the login work locally? Lets test that out.</p>
  <p>Close all apps. (DO A REBOOT, ENSURE EVERTHING IS INITIALISED)</p>
  <p>Run SwimClubMeet and try this login...</p>
  <p><img src="../assets/images/TestLogin.JPG" /></p>
  <p>Did it work? Can you edit, delete, move stuff about? If it&#39;s worked - then your scmAdmin user is up and running.</p>
  <p>Now we&#39;ll attempt to use the Loop-Back feature to test an IP connection. Disconnect from Wi-Fi. Remove ethernet cable, etc. (Restart PC?) Then try this... </p>
  <p><img src="../assets/images/TestLogin2.JPG" /></p>
  <p>Note the comma after the IP address, then the static port number 1433. Did it work? This isn&#39;t a solid test for IP connectivity - but it&#39;s a good indicator all is well. </p>
  <h3 class="SCM_h3">LIFT OFF</h3>
  <p>Well you are ready for the real world now. Get connected via local Wi-Fi, physical router or the internet! </p>
  <p>AFTER CONNECTION  - Check your server IP address in Computer Management - Protocols for SQLEXPRESS (typically IP4 or IP6) . </p>
  <p>You can also use ipconfig at the command line tool to find your current computer&#39;s ip address - the SQLEXPRESS server should be using these addresses. (?)</p>
  <p>On the computer connecting ...</p>
  <ul class="Disc">
    <li>Prepare it&#39;s firewall to allow communications on port 1433 .</li>
    <li>When logging in, use the IP address and port of the (remote) SQLEXPRESS server.</li>
    <li>Login with username scmAdmin and password.</li>
  </ul>
  <h2 class="SCM_h2">Router Configuration..</h2>
  <p><span class="expandtext">Important notes: </span></p>
  <p><span class="expandtext">Wi-Fi routers will need &#39;Port Forwarding&#39; enabled for the 1433 port. (both TCP UDP) </span></p>
  <p><span class="expandtext">Your router acts as DNS and assigns IP adresses to each connection. Most routers have a setting to &#39;lease&#39; a fixed IP address to the same computer on connection. The &#39;lease time&#39; can be hours or &#39;forever&#39;. Consider setting the lease time for computer with the MS SQL server to &#39;forever&#39;. That way the login IP address will always be same. </span></p>
  <p><span class="expandtext">As each router is different, sorry no help session, instead refer to your router&#39;s manual..</span></p>
  <p> </p>
  <p> </p>
  <p> </p>
  <p> </p>
  <p> </p>
  <p> </p>
</body>
</html>